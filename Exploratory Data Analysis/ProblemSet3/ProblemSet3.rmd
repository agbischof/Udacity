Problem Set 3
========================================================
  
***
  
### Load ggplot library and diamonds data set

```{r}
setwd('/Users/abischof/code/Udacity/Exploratory Data Analysis/ProblemSet3/')
library(ggplot2)
data(diamonds)
names(diamonds)
str(diamonds)
diamonds$color
```


***
  
### Histogram of price of all the diamonds
```{r Pseudo-Facebook User Data}
qplot(price, data = diamonds, binwidth = 100)
```


### Summary of diamond price
```{r}
summary(diamonds$price)

sum(diam500$price < 500)

sum(diamonds$price < 250)

sum(diamonds$price >= 15000)
```

### Histogram of price of lowest peak of the diamonds
```{r Pseudo-Facebook User Data}
qplot(price, data = diamonds, binwidth = 10) + 
  scale_x_continuous(limits = c(300,1500), breaks = seq(0,6000, 50))
```

### Break out the histogram of diamond prices by cut
### end up with 5 histograms in separate panels on the plot
```{r}
qplot(price, data = diamonds, binwidth = 100, 
      xlab = 'Diamond Price ($)', ylab = 'Number of Diamonds') +
  scale_x_continuous(breaks = seq(0,150000, 5000)) + 
  facet_wrap(~cut, ncol = 1)

by(diamonds$price, diamonds$cut, summary)
by(diamonds$price, diamonds$cut, max)
by(diamonds$price, diamonds$cut, min)
by(diamonds$price, diamonds$cut, median)

tapply(diamonds$price, diamonds$cut, summary)
```

```{r}
qplot(price, data = diamonds, binwidth = 200, 
      xlab = 'Diamond Price ($)', ylab = 'Number of Diamonds') + 
  scale_x_continuous(limits = c(0,20000), 
                     breaks = seq(0,150000, 5000)) +   
  facet_wrap(~cut, ncol = 1, scales = 'free_y')
```

### Diamond Price/Carat
```{r}
qplot(price/carat, data = diamonds, binwidth = 0.02,
      color = I('black'), fill = I('#5760AB'),
      xlab = 'Diamond Price/Carat', ylab = 'Number of Diamonds') + 
  scale_x_log10() +
  facet_wrap(~cut, ncol = 1, scales = 'free_y')
```


### Investigate the price of diamonds using box plots, numerical summaries and the following categorical variables: cut, clarity, and color
#by Cut, clarity and color
```{r}
qplot(x = cut, y = price, 
      data = diamonds, 
      geom = 'boxplot')+
  coord_cartesian()

qplot(x = cut, y = price, 
      data = diamonds, 
      geom = 'boxplot')+
  coord_cartesian(ylim = c(0,7000))


tapply(diamonds$price, diamonds$cut, summary)

qplot(x = clarity, y = price, 
      data = diamonds, 
      geom = 'boxplot') + 
  coord_cartesian()

qplot(x = clarity, y = price, 
      data = diamonds, 
      geom = 'boxplot')+
  coord_cartesian(ylim = c(0,7000))

tapply(diamonds$price, diamonds$clarity, summary)

qplot(x = color, y = price, 
      data = diamonds, 
      geom = 'boxplot') +
  coord_cartesian()

qplot(x = color, y = price, 
      data = diamonds, 
      geom = 'boxplot')+
  coord_cartesian(ylim = c(0,8000))

by(diamonds$price, diamonds$color, summary)

IQR(subset(diamonds, color == 'D')$price)
IQR(subset(diamonds, color == 'J')$price)

qplot(x = color, y = price/carat, 
      data = diamonds, 
      geom = 'boxplot') +
  coord_cartesian()

qplot(x = color, y = price/carat, 
      data = diamonds, 
      geom = 'boxplot') +
  coord_cartesian(ylim = c(0,6000))

qplot(x = color, y = price/carat, 
      data = diamonds, 
      geom = 'boxplot') +
  coord_cartesian() +
  facet_wrap(~clarity)

qplot(x = color, y = price/carat, 
      data = diamonds, 
      geom = 'boxplot') +
  coord_cartesian() +
  facet_wrap(~cut)
```


###Investiage carat using frequency polygons
```{r}
qplot(x = carat, 
      data = diamonds, 
      xlab = 'Carat',
      ylab = 'Number of Diamonds',
      binwidth = 0.01, geom = 'freqpoly') +
  scale_x_continuous(limits = c(0, 2), breaks = seq(0, 1, 0.1)) 

qplot(x = carat, 
      data = diamonds, 
      xlab = 'Carat',
      ylab = 'Number of Diamonds',
      binwidth = 0.01, geom = 'freqpoly', color = color) +
  scale_x_continuous(limits = c(0,1)) 
```

###Investigate breast cancer data from Gapminder
```{r}
BC = read.csv('BreastCancerMortaility.csv', na.strings='NA', header = T, row.names=1, blank.lines.skip=T)

BCt = data.frame(t(BC))

qplot(x = , data = BC)
qplot(x = X2002, data = BC)

BC$country = rownames(BC)

HSpend = read.csv('HealthSpending.csv', na.strings='NA', header=T, row.names=1, blank.lines.skip=T)
HSpend$country = rownames(HSpend)

BCandHS02 = merge(BC[,c('X2002', 'country')], HSpend[,c('X2002', 'country')], by='country')

BCandHS = merge(BC, HSpend, by='country')

qplot(x = X2002.x, data = BCandHS, binwidth = 20)
qplot(x = X2002.y, data = BCandHS, binwidth = 20)

summary(BCandHS$X2002.y)

BCandHS$HS = NA
BCandHS$HS = ifelse(BCandHS$X2002.y <= 24.21, 'vl', NA)

BCandHS$HS = ifelse(BCandHS$X2002.y > 24.21 & BCandHS$X2002.y <= 105.00, 'l', BCandHS$HS)

BCandHS$HS = ifelse(BCandHS$X2002.y > 105.00 & BCandHS$X2002.y <= 376.10, 'h', BCandHS$HS)

BCandHS$HS = ifelse(BCandHS$X2002.y > 376.10, 'vh', BCandHS$HS)


hsLevels = c("vl", "l", "h", "vh")

BCandHS$HS = factor(BCandHS$HS, levels = hsLevels)

qplot(x = X2002.x, data = subset(BCandHS, !is.na(X2002.y)), 
      binwidth = 1) +
  scale_x_continuous() + 
  facet_wrap(~HS)

qplot(x = X2002.x, y = ..count../sum(..count..), 
      data = subset(BCandHS, !is.na(X2002.y)), 
      xlab = 'Breast Cancer Mortality',
      ylab = 'Proportion of countries',
      binwidth = 4, geom = 'freqpoly', color = HS) +
  scale_x_continuous() 

qplot(x = HS, y = X2002.x, 
      data = subset(BCandHS, !is.na(X2002.y)),
      xlab = 'Health Spending',
      ylab = 'Breast Cancer Mortaility',
      geom = 'boxplot')
```


***